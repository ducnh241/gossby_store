<?php

use Aws\CommandPool;
use Aws\S3\S3Client;

class Cron_Developer_MigrateOptionsDesignOrder extends OSC_Cron_Abstract {
    /**
     * @throws Exception
     */
    public function process($params, $queue_added_timestamp) {
        set_time_limit(0);
        ini_set('memory_limit', '-1');
        try {
            $test_flag = intval($params['test_flag']) == 1 ? 1 : 0;

            $feelik_shop_id = $test_flag != 0 ? OSC::getShop()->getId() : $params['feelik_shop_id'];

            $gossby_product_id = $params['gossby_product_id'];

            $feelik_product_id = $test_flag != 0 ? $gossby_product_id : static::_mappingProductId($gossby_product_id);

            if ($feelik_product_id < 1) {
                throw new Exception('Not have feelik product id mapping with '. $params['gossby_product_id']);
            }

            $list_meta_ids = [];

            $DB_MASTER = OSC::core('database')->getAdapter('db_master');

            $query = "SELECT order_item_meta_id FROM osc_catalog_order_item WHERE shop_id = {$feelik_shop_id} AND product_id = {$feelik_product_id}";

            $DB_MASTER->query($query, null, 'fetch_order_item_by_product');

            $order_items = $DB_MASTER->fetchArrayAll('fetch_order_item_by_product');

            $DB_MASTER->free('fetch_order_item_by_product');

            if(count($order_items) < 1) {
                throw new Exception('Not have order item by feeliks product id '. $feelik_product_id);
            }

            foreach ($order_items as $item) {
                $list_meta_ids[] = $item['order_item_meta_id'];
            }

            $count_meta_ids = count($list_meta_ids);
            $str_meta_ids = implode(',', $list_meta_ids);

            $query = "SELECT master_record_id, meta_id, custom_data FROM osc_catalog_order_item_meta WHERE shop_id = {$feelik_shop_id} AND meta_id in ({$str_meta_ids}) limit {$count_meta_ids}";

            $DB_MASTER->query($query, null, 'fetch_order_item_meta');

            $item_metas = $DB_MASTER->fetchArrayAll('fetch_order_item_meta');

            $DB_MASTER->free('fetch_order_item_meta');

            foreach ($item_metas as $item_meta) {
                $queue_data = [];
                foreach (OSC::decode($item_meta['custom_data']) as $custom_data) {
                    if ($custom_data['key'] == 'campaign' &&
                        isset($custom_data['data']['print_template']) &&
                        is_array($custom_data['data']['print_template']) &&
                        isset($custom_data['data']['print_template']['segment_source']) &&
                        is_array($custom_data['data']['print_template']['segment_source']) &&
                        count($custom_data['data']['print_template']['segment_source']) > 0) {

                        foreach($custom_data['data']['print_template']['segment_source'] as $segment) {
                            if(is_array($segment) && isset($segment['source']) && is_array($segment['source']) && isset($segment['source']['type']) && $segment['source']['type'] == 'personalizedDesign') {
                                $queue_item = [
                                    'design_id' => $test_flag != 0 ? $segment['source']['design_id'] : static::_mappingDesignId($segment['source']['design_id']),
                                    'operator' => 'increment',
                                    'data' => []
                                ];

                                foreach($segment['source']['config'] as $k => $v) {
                                    if(! isset($segment['source']['config_preview'][$k])) {
                                        $queue_item['data'][$k] = [
                                            'layer' => 'Unknown layer',
                                            'form' => 'Unknown form',
                                            'parsed_value' => 'Unknown value',
                                            'value_hash' => '',
                                            'value' => $v
                                        ];
                                    } else {
                                        if($segment['source']['config_preview'][$k]['type'] == 'input') {
                                            continue;
                                        }

                                        $queue_item['data'][$k] = [
                                            'layer' => $segment['source']['config_preview'][$k]['layer'],
                                            'form' => $segment['source']['config_preview'][$k]['form'],
                                            'parsed_value' => $segment['source']['config_preview'][$k]['value'],
                                            'value_hash' => isset($segment['source']['config_preview'][$k]['hash']) ? $segment['source']['config_preview'][$k]['hash'] : '',
                                            'value' => $v
                                        ];
                                    }
                                }

                                $queue_data[] = $queue_item;
                            }
                        }

                        break;
                    }
                }
                if(count($queue_data) > 0) {
                    OSC::model('personalizedDesign/analyticProcessQueue')->setData([
                        'queue_data' => $queue_data,
                        'added_timestamp' => time()
                    ])->save();
                }
            }
        } catch (Exception $ex) {
            OSC::logFile('Error:: Meta id #'. $ex->getMessage(), 'migrate_option_design_order');
        }
    }

    protected function _mappingProductId($gossby_product_id) {
        // data mapping with sku gossby = sku feeliks
        $mapping_product_ids = [
            5271 => 160,
            5272 => 163,
            5273 => 1272,
            5274 => 1342,
            5275 => 1343,
            5276 => 1375,
            5277 => 1574,
            5278 => 1577,
            5279 => 1578,
            5280 => 1590,
            5281 => 1591,
            5282 => 1592,
            5283 => 1593,
            5284 => 1594,
            5285 => 1595,
            5286 => 1596,
            5287 => 1597,
            5288 => 1598,
            5289 => 1599,
            5290 => 1600,
            5291 => 1601,
            5292 => 1602,
            5293 => 1603,
            5294 => 1604,
            5295 => 1605,
            5296 => 1606,
            5297 => 1607,
            5298 => 1608,
            5299 => 1609,
            5300 => 1610,
            5301 => 1622,
            5302 => 1667,
            5303 => 1668,
            5304 => 1669,
            5305 => 1670,
            5306 => 1671,
            5307 => 1684,
            5308 => 1685,
            5309 => 1686,
            5310 => 1694,
            5311 => 1695,
            5312 => 1697,
            5313 => 1714,
            5314 => 1715,
            5315 => 1716,
            5316 => 1717,
            5317 => 1718,
            5318 => 1719,
            5319 => 1724,
            5320 => 1725,
            5321 => 1735,
            5322 => 1736,
            5323 => 1781,
            5324 => 1783,
            5325 => 1784,
            5326 => 1785,
            5327 => 1796,
            5328 => 1820,
            5329 => 1821,
            5330 => 1822,
            5331 => 1823,
            5332 => 1848,
            5333 => 1849,
            5334 => 1850,
            5335 => 1851,
            5336 => 1853,
            5337 => 1854,
            5338 => 1855,
            5339 => 1856,
            5340 => 1857,
            5341 => 1858,
            5342 => 1861,
            5343 => 1862,
            5344 => 1863,
            5345 => 1864,
            5346 => 1865,
            5347 => 1866,
            5348 => 1885,
            5349 => 1903,
            5350 => 1905,
            5351 => 1906,
            5352 => 1907,
            5353 => 1908,
            5354 => 1910,
            5355 => 1911,
            5356 => 1912,
            5357 => 1913,
            5358 => 1914,
            5359 => 1915,
            5360 => 1927,
            5361 => 1938,
            5363 => 1941,
            5364 => 1948,
            5368 => 1952,
            5370 => 1954,
            5374 => 1958,
            5377 => 1961,
            5378 => 1967,
            13254 => 2020,
            5379 => 2031,
            5380 => 2032,
            5381 => 2033,
            5382 => 2034,
            5383 => 2035,
            5384 => 2061,
            5388 => 2085,
            5389 => 2086,
            5390 => 2087,
            5391 => 2088,
            5392 => 2089,
            5393 => 2142,
            5394 => 2154,
            5395 => 2159,
            5396 => 2198,
            5397 => 2199,
            5398 => 2285,
            5399 => 2384,
            5400 => 2385,
            5401 => 2386,
            5402 => 2387,
            5403 => 2388,
            5404 => 2389,
            5405 => 2390,
            5406 => 2421,
            5407 => 2422,
            5408 => 2423,
            5409 => 2444,
            5410 => 2447,
            5411 => 2448,
            13261 => 2538,
            13262 => 2542,
            13263 => 2543,
            13265 => 2546,
            5412 => 2550,
            5413 => 2551,
            13266 => 2552,
            13267 => 2553,
            13268 => 2555,
            5414 => 2557,
            13269 => 2564,
            5415 => 2568,
            5416 => 2580,
            13270 => 2583,
            5417 => 2596,
            5418 => 2610,
            13271 => 2633,
            13272 => 2636,
            13273 => 2640,
            13274 => 2641,
            13275 => 2642,
            13276 => 2644,
            13277 => 2650,
            13278 => 2655,
            13279 => 2656,
            13280 => 2694,
            13281 => 2712,
            13282 => 2815,
            13283 => 2816,
            13284 => 2817,
            13285 => 2818,
            5419 => 2824,
            5420 => 2830,
            5421 => 2831,
            5422 => 2832,
            5423 => 2833,
            5424 => 2857,
            5425 => 2861,
            13287 => 2882,
            13288 => 2883,
            13289 => 2884,
            13290 => 2885,
            13291 => 2886,
            13292 => 2887,
            5426 => 2899,
            5427 => 2900,
            5429 => 2903,
            5430 => 2905,
            5431 => 2906,
            5432 => 2907,
            5433 => 2909,
            5434 => 2910,
            5435 => 2911,
            13296 => 2912,
            13297 => 2913,
            5436 => 2915,
            5437 => 2916,
            5438 => 2917,
            5439 => 2918,
            5440 => 2919,
            5441 => 2920,
            5443 => 2922,
            5444 => 2923,
            5445 => 2924,
            5446 => 2925,
            13299 => 2926,
            13300 => 2927,
            13301 => 2928,
            5447 => 2929,
            5448 => 2930,
            5449 => 2931,
            13302 => 2932,
            13303 => 2934,
            13304 => 2936,
            13305 => 2937,
            13306 => 2938,
            5451 => 2939,
            13307 => 2940,
            5452 => 2941,
            13308 => 2942,
            13309 => 2943,
            5453 => 2944,
            13310 => 2945,
            13311 => 2946,
            5454 => 2947,
            5455 => 2948,
            5456 => 2949,
            5457 => 2951,
            5458 => 2952,
            5459 => 2953,
            5460 => 2954,
            5461 => 2955,
            5462 => 2956,
            5463 => 2957,
            5464 => 2958,
            5465 => 2959,
            5466 => 2960,
            5467 => 2961,
            5469 => 2963,
            5473 => 2967,
            5475 => 2969,
            5477 => 2971,
            5479 => 2973,
            5480 => 2974,
            5481 => 2975,
            5482 => 2976,
            13314 => 2981,
            13315 => 2982,
            13316 => 2990,
            13317 => 2991,
            13318 => 2992,
            13319 => 2993,
            5492 => 2997,
            5496 => 3001,
            13320 => 3004,
            5500 => 3007,
            5501 => 3008,
            5502 => 3009,
            5503 => 3010,
            5505 => 3012,
            5506 => 3013,
            5507 => 3016,
            5508 => 3017,
            5509 => 3020,
            5510 => 3021,
            5511 => 3022,
            5512 => 3023,
            5513 => 3024,
            5514 => 3025,
            5515 => 3026,
            5516 => 3027,
            13321 => 3029,
            13322 => 3030,
            5517 => 3031,
            5518 => 3032,
            5519 => 3033,
            5520 => 3034,
            5521 => 3035,
            5522 => 3036,
            5524 => 3038,
            5526 => 3040,
            5527 => 3041,
            5528 => 3042,
            5529 => 3043,
            5530 => 3044,
            5531 => 3045,
            5532 => 3046,
            5533 => 3047,
            5534 => 3049,
            5535 => 3050,
            5536 => 3051,
            5537 => 3052,
            5538 => 3053,
            5539 => 3054,
            5540 => 3055,
            5541 => 3056,
            5542 => 3057,
            5543 => 3058,
            5544 => 3059,
            5545 => 3060,
            5546 => 3061,
            5547 => 3062,
            5548 => 3063,
            5549 => 3064,
            5550 => 3065,
            5551 => 3066,
            5552 => 3067,
            5553 => 3068,
            5554 => 3069,
            5555 => 3070,
            5556 => 3071,
            13323 => 3073,
            13324 => 3074,
            13325 => 3075,
            13326 => 3076,
            13327 => 3077,
            13328 => 3078,
            5557 => 3079,
            13329 => 3080,
            13330 => 3081,
            13331 => 3082,
            13332 => 3083,
            13333 => 3084,
            5558 => 3085,
            13334 => 3086,
            5559 => 3087,
            5560 => 3088,
            5561 => 3089,
            5562 => 3091,
            5563 => 3092,
            13335 => 3093,
            13336 => 3094,
            13337 => 3095,
            13338 => 3096,
            13339 => 3097,
            13340 => 3098,
            13341 => 3099,
            13342 => 3100,
            13343 => 3101,
            13344 => 3102,
            13345 => 3103,
            13346 => 3104,
            13347 => 3105,
            13348 => 3106,
            13349 => 3107,
            13350 => 3108,
            13351 => 3109,
            13352 => 3110,
            13353 => 3111,
            13354 => 3112,
            13355 => 3113,
            13356 => 3114,
            13357 => 3115,
            13358 => 3116,
            13359 => 3117,
            13360 => 3118,
            13361 => 3119,
            13362 => 3120,
            13363 => 3121,
            13364 => 3122,
            13365 => 3123,
            13366 => 3124,
            13367 => 3125,
            13368 => 3126,
            13369 => 3127,
            5564 => 3128,
            5565 => 3129,
            5566 => 3130,
            5567 => 3131,
            5568 => 3132,
            5569 => 3133,
            13370 => 3134,
            5570 => 3135,
            13371 => 3136,
            13372 => 3137,
            13373 => 3138,
            13374 => 3139,
            13375 => 3140,
            5571 => 3141,
            5572 => 3142,
            5573 => 3143,
            5574 => 3144,
            5575 => 3145,
            5576 => 3146,
            5577 => 3147,
            5578 => 3148,
            5579 => 3149,
            5580 => 3150,
            5581 => 3152,
            5582 => 3153,
            5583 => 3154,
            5584 => 3155,
            5585 => 3156,
            5586 => 3157,
            5587 => 3158,
            5588 => 3159,
            5590 => 3161,
            5591 => 3162,
            5592 => 3163,
            5593 => 3164,
            5595 => 3166,
            5596 => 3167,
            5597 => 3168,
            5598 => 3169,
            5599 => 3170,
            5600 => 3171,
            5601 => 3172,
            5602 => 3173,
            5603 => 3174,
            5604 => 3175,
            5605 => 3176,
            5607 => 3178,
            5609 => 3180,
            5610 => 3181,
            5611 => 3182,
            5612 => 3183,
            5613 => 3184,
            5614 => 3185,
            13377 => 3186,
            13378 => 3187,
            13379 => 3188,
            13380 => 3189,
            13381 => 3190,
            13382 => 3191,
            13383 => 3192,
            5615 => 3193,
            5616 => 3194,
            13384 => 3195,
            13385 => 3196,
            13386 => 3197,
            13387 => 3198,
            13388 => 3199,
            13389 => 3200,
            13390 => 3201,
            5617 => 3202,
            5618 => 3203,
            5619 => 3204,
            5620 => 3205,
            5621 => 3206,
            5622 => 3207,
            5623 => 3208,
            5624 => 3209,
            5625 => 3210,
            5626 => 3211,
            13391 => 3212,
            13392 => 3213,
            5627 => 3214,
            5628 => 3215,
            13393 => 3216,
            5629 => 3217,
            5630 => 3218,
            5631 => 3219,
            5634 => 3223,
            5635 => 3224,
            5636 => 3225,
            5637 => 3226,
            5638 => 3227,
            5639 => 3228,
            5640 => 3229,
            5641 => 3230,
            5643 => 3232,
            5644 => 3233,
            5645 => 3234,
            5646 => 3235,
            5647 => 3236,
            5648 => 3237,
            5649 => 3238,
            5650 => 3239,
            5651 => 3241,
            5652 => 3242,
            5653 => 3243,
            5654 => 3244,
            5655 => 3245,
            5656 => 3246,
            5657 => 3247,
            5658 => 3248,
            5659 => 3249,
            5660 => 3250,
            5661 => 3251,
            5662 => 3252,
            5663 => 3253,
            5664 => 3254,
            5665 => 3255,
            5666 => 3256,
            5667 => 3257,
            5668 => 3258,
            5669 => 3259,
            5670 => 3260,
            5671 => 3261,
            5672 => 3262,
            5673 => 3263,
            5674 => 3264,
            5675 => 3265,
            5676 => 3266,
            5677 => 3267,
            5678 => 3268,
            5679 => 3269,
            5680 => 3270,
            5681 => 3271,
            13395 => 3272,
            13396 => 3273,
            13397 => 3275,
            13398 => 3276,
            13399 => 3277,
            13400 => 3278,
            13401 => 3279,
            5682 => 3280,
            5683 => 3281,
            5684 => 3282,
            5685 => 3283,
            5686 => 3284,
            5687 => 3285,
            5688 => 3286,
            5689 => 3287,
            13402 => 3288,
            13404 => 3290,
            5690 => 3291,
            5691 => 3292,
            5692 => 3293,
            5693 => 3294,
            5694 => 3295,
            5695 => 3296,
            5696 => 3297,
            5697 => 3298,
            5698 => 3299,
            5699 => 3300,
            5701 => 3302,
            5702 => 3303,
            5703 => 3304,
            5704 => 3305,
            5705 => 3306,
            5706 => 3307,
            5707 => 3308,
            5708 => 3309,
            5709 => 3310,
            5710 => 3311,
            5711 => 3312,
            5712 => 3313,
            5713 => 3314,
            5716 => 3317,
            5718 => 3319,
            5720 => 3321,
            5721 => 3322,
            5722 => 3323,
            5723 => 3324,
            5724 => 3325,
            5725 => 3326,
            5726 => 3327,
            5727 => 3328,
            5728 => 3329,
            5729 => 3330,
            5730 => 3331,
            5731 => 3332,
            5732 => 3333,
            5733 => 3334,
            5734 => 3335,
            5735 => 3336,
            5736 => 3337,
            5737 => 3338,
            5738 => 3339,
            5739 => 3340,
            5740 => 3341,
            13405 => 3342,
            13406 => 3343,
            5741 => 3344,
            5742 => 3345,
            5743 => 3346,
            5744 => 3347,
            5745 => 3348,
            5746 => 3349,
            5747 => 3350,
            5748 => 3351,
            5749 => 3352,
            5750 => 3353,
            5751 => 3354,
            5752 => 3355,
            5753 => 3356,
            5754 => 3357,
            5755 => 3358,
            5756 => 3359,
            5757 => 3360,
            5758 => 3361,
            5759 => 3362,
            5760 => 3363,
            5761 => 3364,
            5762 => 3365,
            5763 => 3366,
            5765 => 3368,
            5766 => 3369,
            5767 => 3370,
            5768 => 3371,
            5769 => 3372,
            5770 => 3373,
            5771 => 3374,
            5772 => 3375,
            5773 => 3376,
            5774 => 3377,
            5775 => 3378,
            5776 => 3379,
            5777 => 3380,
            5778 => 3381,
            5779 => 3382,
            5780 => 3383,
            5781 => 3384,
            5782 => 3385,
            5783 => 3386,
            5784 => 3387,
            5785 => 3388,
            5786 => 3389,
            5787 => 3390,
            5788 => 3391,
            5789 => 3392,
            5790 => 3393,
            5791 => 3394,
            5792 => 3395,
            5793 => 3396,
            5794 => 3397,
            5798 => 3401,
            5802 => 3405,
            5803 => 3406,
            5806 => 3409,
            5807 => 3410,
            5808 => 3411,
            5809 => 3412,
            5810 => 3413,
            5811 => 3414,
            5812 => 3415,
            5814 => 3417,
            5817 => 3420,
            5818 => 3421,
            5819 => 3422
        ];

        if (! isset($mapping_product_ids[$gossby_product_id])) {
            return 0;
        }

        return $mapping_product_ids[$gossby_product_id] ?? 1;
    }

    protected function _mappingDesignId($feelik_design_id) {
        // data mapping with feeliks.design.ukey = gossby.design.ukey
        $mapping_design_ids = [
            1060 => 1060,
            1010 => 1010,
            1049 => 1049,
            1344 => 1344,
            836 => 836,
            615 => 615,
            1187 => 1187,
            1357 => 1357,
            2682 => 1696,
            5457 => 1530,
            1053 => 1053,
            1452 => 1452,
            2669 => 1659,
            1447 => 1447,
            2617 => 1545,
            2672 => 1682,
            2621 => 1554,
            662 => 662,
            631 => 631,
            2653 => 1633,
            781 => 781,
            859 => 859,
            1204 => 1204,
            889 => 889,
            2677 => 1687,
            811 => 811,
            2643 => 1616,
            1481 => 1481,
            1291 => 1291,
            694 => 694,
            782 => 782,
            1022 => 1022,
            1115 => 1115,
            788 => 788,
            1154 => 1154,
            768 => 768,
            1011 => 1011,
            5463 => 1552,
            1324 => 1324,
            2606 => 1513,
            1098 => 1098,
            1301 => 1301,
            2691 => 1707,
            977 => 977,
            1263 => 1263,
            1252 => 1252,
            586 => 586,
            1139 => 1139,
            718 => 718,
            1174 => 1174,
            961 => 961,
            1391 => 1391,
            807 => 807,
            1283 => 1283,
            871 => 871,
            1126 => 1126,
            1256 => 1256,
            653 => 653,
            833 => 833,
            1257 => 1257,
            1173 => 1173,
            1265 => 1265,
            736 => 736,
            1352 => 1352,
            1074 => 1074,
            1239 => 1239,
            1030 => 1030,
            966 => 966,
            5453 => 1519,
            766 => 766,
            1123 => 1123,
            921 => 921,
            1347 => 1347,
            1242 => 1242,
            827 => 827,
            1028 => 1028,
            857 => 857,
            975 => 975,
            1258 => 1258,
            701 => 701,
            580 => 580,
            605 => 605,
            1048 => 1048,
            996 => 996,
            1233 => 1233,
            2623 => 1560,
            1498 => 1498,
            1328 => 1328,
            959 => 959,
            1501 => 1501,
            1249 => 1249,
            870 => 870,
            600 => 600,
            1339 => 1339,
            556 => 556,
            1116 => 1116,
            680 => 680,
            758 => 758,
            2650 => 1629,
            5496 => 1647,
            1216 => 1216,
            1213 => 1213,
            861 => 861,
            5466 => 1562,
            1505 => 1505,
            1322 => 1322,
            575 => 575,
            1155 => 1155,
            1470 => 1470,
            1138 => 1138,
            902 => 902,
            1149 => 1149,
            735 => 735,
            1136 => 1136,
            597 => 597,
            2618 => 1546,
            1488 => 1488,
            5454 => 1525,
            890 => 890,
            1230 => 1230,
            2680 => 1694,
            1040 => 1040,
            885 => 885,
            1208 => 1208,
            931 => 931,
            1078 => 1078,
            901 => 901,
            1133 => 1133,
            1003 => 1003,
            1305 => 1305,
            1247 => 1247,
            737 => 737,
            1215 => 1215,
            5497 => 1648,
            1013 => 1013,
            909 => 909,
            584 => 584,
            1313 => 1313,
            804 => 804,
            2663 => 1661,
            1342 => 1342,
            1271 => 1271,
            648 => 648,
            617 => 617,
            1340 => 1340,
            1370 => 1370,
            1310 => 1310,
            603 => 603,
            1071 => 1071,
            1166 => 1166,
            640 => 640,
            1300 => 1300,
            1259 => 1259,
            1125 => 1125,
            834 => 834,
            686 => 686,
            549 => 549,
            1277 => 1277,
            839 => 839,
            908 => 908,
            561 => 561,
            999 => 999,
            1299 => 1299,
            709 => 709,
            1042 => 1042,
            2686 => 1701,
            800 => 800,
            1214 => 1214,
            1317 => 1317,
            1225 => 1225,
            823 => 823,
            518 => 518,
            661 => 661,
            1411 => 1411,
            1026 => 1026,
            1107 => 1107,
            2620 => 1548,
            1438 => 1438,
            1497 => 1497,
            1134 => 1134,
            704 => 704,
            703 => 703,
            1343 => 1343,
            2651 => 1630,
            936 => 936,
            674 => 674,
            1143 => 1143,
            869 => 869,
            1240 => 1240,
            1437 => 1437,
            853 => 853,
            2638 => 1581,
            1487 => 1487,
            824 => 824,
            1279 => 1279,
            730 => 730,
            585 => 585,
            1421 => 1421,
            1404 => 1404,
            795 => 795,
            2694 => 1709,
            1203 => 1203,
            1396 => 1396,
            1428 => 1428,
            1327 => 1327,
            2662 => 1660,
            1224 => 1224,
            1392 => 1392,
            1379 => 1379,
            1228 => 1228,
            1169 => 1169,
            565 => 565,
            1083 => 1083,
            616 => 616,
            629 => 629,
            903 => 903,
            1045 => 1045,
            989 => 989,
            764 => 764,
            5495 => 1643,
            855 => 855,
            571 => 571,
            2678 => 1688,
            1113 => 1113,
            1282 => 1282,
            1251 => 1251,
            611 => 611,
            714 => 714,
            1429 => 1429,
            1469 => 1469,
            1038 => 1038,
            948 => 948,
            1407 => 1407,
            1210 => 1210,
            974 => 974,
            623 => 623,
            5481 => 1605,
            1359 => 1359,
            1095 => 1095,
            932 => 932,
            1238 => 1238,
            1495 => 1495,
            1070 => 1070,
            944 => 944,
            515 => 515,
            1266 => 1266,
            1410 => 1410,
            596 => 596,
            1353 => 1353,
            1114 => 1114,
            567 => 567,
            1360 => 1360,
            1140 => 1140,
            1286 => 1286,
            1294 => 1294,
            860 => 860,
            1085 => 1085,
            1275 => 1275,
            1158 => 1158,
            2639 => 1580,
            5472 => 1591,
            663 => 663,
            884 => 884,
            1250 => 1250,
            1135 => 1135,
            1084 => 1084,
            1103 => 1103,
            792 => 792,
            1431 => 1431,
            5494 => 1640,
            962 => 962,
            598 => 598,
            816 => 816,
            864 => 864,
            995 => 995,
            1206 => 1206,
            1475 => 1475,
            5508 => 1672,
            1433 => 1433,
            2635 => 1576,
            1014 => 1014,
            687 => 687,
            5451 => 1520,
            973 => 973,
            1091 => 1091,
            1436 => 1436,
            717 => 717,
            980 => 980,
            821 => 821,
            802 => 802,
            589 => 589,
            667 => 667,
            1465 => 1465,
            1356 => 1356,
            1161 => 1161,
            856 => 856,
            994 => 994,
            1168 => 1168,
            624 => 624,
            1402 => 1402,
            5476 => 1597,
            626 => 626,
            1073 => 1073,
            602 => 602,
            907 => 907,
            2640 => 1582,
            628 => 628,
            5448 => 1515,
            1179 => 1179,
            913 => 913,
            1036 => 1036,
            988 => 988,
            1223 => 1223,
            5510 => 1675,
            671 => 671,
            5449 => 1516,
            785 => 785,
            5468 => 1588,
            1046 => 1046,
            1122 => 1122,
            1419 => 1419,
            898 => 898,
            1509 => 1509,
            1176 => 1176,
            1304 => 1304,
            900 => 900,
            779 => 779,
            1311 => 1311,
            1422 => 1422,
            899 => 899,
            2693 => 1704,
            947 => 947,
            1237 => 1237,
            866 => 866,
            1075 => 1075,
            1474 => 1474,
            2671 => 1681,
            1153 => 1153,
            756 => 756,
            744 => 744,
            918 => 918,
            831 => 831,
            1066 => 1066,
            1321 => 1321,
            946 => 946,
            5480 => 1603,
            942 => 942,
            1241 => 1241,
            1439 => 1439,
            924 => 924,
            928 => 928,
            1415 => 1415,
            682 => 682,
            906 => 906,
            1425 => 1425,
            2649 => 1626,
            1231 => 1231,
            1472 => 1472,
            1331 => 1331,
            1444 => 1444,
            5489 => 1617,
            810 => 810,
            2612 => 1537,
            689 => 689,
            1367 => 1367,
            1035 => 1035,
            2637 => 1571,
            797 => 797,
            1120 => 1120,
            739 => 739,
            5474 => 1594,
            535 => 535,
            2659 => 1641,
            1127 => 1127,
            1292 => 1292,
            1463 => 1463,
            1333 => 1333,
            1202 => 1202,
            2614 => 1539,
            1222 => 1222,
            997 => 997,
            777 => 777,
            1056 => 1056,
            1435 => 1435,
            862 => 862,
            582 => 582,
            1375 => 1375,
            830 => 830,
            2661 => 1657,
            1061 => 1061,
            844 => 844,
            858 => 858,
            2673 => 1684,
            550 => 550,
            1383 => 1383,
            606 => 606,
            583 => 583,
            2670 => 1680,
            1100 => 1100,
            1296 => 1296,
            664 => 664,
            1037 => 1037,
            2619 => 1547,
            5460 => 1528,
            828 => 828,
            812 => 812,
            1192 => 1192,
            590 => 590,
            1121 => 1121,
            753 => 753,
            1424 => 1424,
            957 => 957,
            677 => 677,
            1273 => 1273,
            1062 => 1062,
            750 => 750,
            1417 => 1417,
            1442 => 1442,
            5482 => 1606,
            784 => 784,
            1041 => 1041,
            970 => 970,
            2644 => 1622,
            559 => 559,
            1278 => 1278,
            716 => 716,
            1502 => 1502,
            832 => 832,
            892 => 892,
            1303 => 1303,
            5498 => 1649,
            5456 => 1531,
            1007 => 1007,
            728 => 728,
            591 => 591,
            1318 => 1318,
            1111 => 1111,
            1217 => 1217,
            1454 => 1454,
            678 => 678,
            905 => 905,
            2654 => 1558,
            609 => 609,
            881 => 881,
            1077 => 1077,
            5473 => 1595,
            1112 => 1112,
            2683 => 1698,
            854 => 854,
            593 => 593,
            848 => 848,
            2630 => 1570,
            5485 => 1613,
            618 => 618,
            1033 => 1033,
            1492 => 1492,
            625 => 625,
            727 => 727,
            922 => 922,
            1272 => 1272,
            968 => 968,
            754 => 754,
            793 => 793,
            1297 => 1297,
            2645 => 1623,
            520 => 520,
            1232 => 1232,
            1287 => 1287,
            554 => 554,
            2675 => 1683,
            981 => 981,
            1194 => 1194,
            733 => 733,
            1361 => 1361,
            573 => 573,
            1405 => 1405,
            657 => 657,
            882 => 882,
            1418 => 1418,
            715 => 715,
            1094 => 1094,
            5465 => 1557,
            1500 => 1500,
            1456 => 1456,
            1034 => 1034,
            534 => 534,
            1190 => 1190,
            1416 => 1416,
            1015 => 1015,
            1261 => 1261,
            1369 => 1369,
            1131 => 1131,
            1097 => 1097,
            778 => 778,
            636 => 636,
            1381 => 1381,
            1335 => 1335,
            1102 => 1102,
            683 => 683,
            1124 => 1124,
            630 => 630,
            1351 => 1351,
            887 => 887,
            1478 => 1478,
            1430 => 1430,
            538 => 538,
            578 => 578,
            1047 => 1047,
            987 => 987,
            1211 => 1211,
            2628 => 1550,
            1200 => 1200,
            1449 => 1449,
            1476 => 1476,
            976 => 976,
            655 => 655,
            1362 => 1362,
            1260 => 1260,
            760 => 760,
            639 => 639,
            1412 => 1412,
            757 => 757,
            1221 => 1221,
            2624 => 1561,
            896 => 896,
            1455 => 1455,
            1201 => 1201,
            1229 => 1229,
            1063 => 1063,
            2679 => 1692,
            1473 => 1473,
            647 => 647,
            660 => 660,
            5487 => 1607,
            1510 => 1510,
            592 => 592,
            1008 => 1008,
            867 => 867,
            1055 => 1055,
            939 => 939,
            5511 => 1676,
            763 => 763,
            772 => 772,
            2660 => 1642,
            1390 => 1390,
            570 => 570,
            817 => 817,
            650 => 650,
            873 => 873,
            982 => 982,
            711 => 711,
            1023 => 1023,
            5490 => 1615,
            789 => 789,
            614 => 614,
            747 => 747,
            1314 => 1314,
            2668 => 1604,
            1403 => 1403,
            732 => 732,
            544 => 544,
            1349 => 1349,
            914 => 914,
            1171 => 1171,
            983 => 983,
            1184 => 1184,
            2690 => 1706,
            1191 => 1191,
            1245 => 1245,
            604 => 604,
            696 => 696,
            876 => 876,
            1099 => 1099,
            1170 => 1170,
            581 => 581,
            1235 => 1235,
            938 => 938,
            1295 => 1295,
            791 => 791,
            929 => 929,
            1461 => 1461,
            1205 => 1205,
            1274 => 1274,
            1181 => 1181,
            1236 => 1236,
            1432 => 1432,
            5450 => 1521,
            837 => 837,
            1177 => 1177,
            1477 => 1477,
            5484 => 1612,
            632 => 632,
            1159 => 1159,
            1336 => 1336,
            2676 => 1686,
            849 => 849,
            1090 => 1090,
            1450 => 1450,
            568 => 568,
            950 => 950,
            798 => 798,
            904 => 904,
            1088 => 1088,
            5462 => 1551,
            621 => 621,
            1219 => 1219,
            2666 => 1674,
            893 => 893,
            846 => 846,
            978 => 978,
            576 => 576,
            765 => 765,
            1348 => 1348,
            806 => 806,
            1448 => 1448,
            1382 => 1382,
            1368 => 1368,
            1227 => 1227,
            897 => 897,
            1308 => 1308,
            1464 => 1464,
            2629 => 1569,
            790 => 790,
            2642 => 1592,
            1207 => 1207,
            1101 => 1101,
            894 => 894,
            1453 => 1453,
            635 => 635,
            1373 => 1373,
            1319 => 1319,
            574 => 574,
            843 => 843,
            610 => 610,
            2655 => 1651,
            1440 => 1440,
            769 => 769,
            1209 => 1209,
            1052 => 1052,
            1087 => 1087,
            986 => 986,
            5501 => 1653,
            2607 => 1518,
            1164 => 1164,
            2656 => 1644,
            1148 => 1148,
            675 => 675,
            818 => 818,
            845 => 845,
            1408 => 1408,
            2632 => 1573,
            1380 => 1380,
            1394 => 1394,
            945 => 945,
            984 => 984,
            935 => 935,
            1175 => 1175,
            919 => 919,
            1152 => 1152,
            956 => 956,
            1150 => 1150,
            546 => 546,
            2633 => 1574,
            1267 => 1267,
            2664 => 1662,
            1354 => 1354,
            1178 => 1178,
            1290 => 1290,
            1309 => 1309,
            1000 => 1000,
            5488 => 1620,
            1413 => 1413,
            1298 => 1298,
            613 => 613,
            2636 => 1577,
            835 => 835,
            1482 => 1482,
            1280 => 1280,
            883 => 883,
            1445 => 1445,
            888 => 888,
            771 => 771,
            1248 => 1248,
            5471 => 1590,
            1142 => 1142,
            826 => 826,
            1195 => 1195,
            1269 => 1269,
            1374 => 1374,
            967 => 967,
            1002 => 1002,
            1284 => 1284,
            990 => 990,
            599 => 599,
            868 => 868,
            572 => 572,
            5479 => 1602,
            1507 => 1507,
            5509 => 1671,
            923 => 923,
            5502 => 1654,
            5491 => 1619,
            1234 => 1234,
            1270 => 1270,
            1086 => 1086,
            958 => 958,
            620 => 620,
            2692 => 1705,
            930 => 930,
            1325 => 1325,
            1157 => 1157,
            5505 => 1665,
            1446 => 1446,
            949 => 949,
            767 => 767,
            925 => 925,
            1457 => 1457,
            1163 => 1163,
            688 => 688,
            1146 => 1146,
            1458 => 1458,
            841 => 841,
            1064 => 1064,
            2611 => 1536,
            532 => 532,
            712 => 712,
            1246 => 1246,
            1068 => 1068,
            1051 => 1051,
            558 => 558,
            1281 => 1281,
            2615 => 1540,
            1144 => 1144,
            669 => 669,
            1395 => 1395,
            1414 => 1414,
            998 => 998,
            5483 => 1609,
            2685 => 1700,
            910 => 910,
            1462 => 1462,
            1129 => 1129,
            1018 => 1018,
            1365 => 1365,
            566 => 566,
            937 => 937,
            519 => 519,
            2627 => 1568,
            607 => 607,
            1039 => 1039,
            1289 => 1289,
            691 => 691,
            1506 => 1506,
            2648 => 1624,
            814 => 814,
            1188 => 1188,
            670 => 670,
            1001 => 1001,
            972 => 972,
            1371 => 1371,
            1104 => 1104,
            749 => 749,
            1378 => 1378,
            1315 => 1315,
            1376 => 1376,
            1409 => 1409,
            5467 => 1585,
            759 => 759,
            5459 => 1535,
            1285 => 1285,
            1105 => 1105,
            445 => 445,
            955 => 955,
            1006 => 1006,
            808 => 808,
            1043 => 1043,
            2625 => 1565,
            1050 => 1050,
            787 => 787,
            1385 => 1385,
            1345 => 1345,
            1494 => 1494,
            1496 => 1496,
            2695 => 1710,
            1337 => 1337,
            1005 => 1005,
            5458 => 1534,
            1165 => 1165,
            799 => 799,
            685 => 685,
            1218 => 1218,
            720 => 720,
            1082 => 1082,
            1079 => 1079,
            1180 => 1180,
            2646 => 1625,
            886 => 886,
            1486 => 1486,
            658 => 658,
            1355 => 1355,
            577 => 577,
            531 => 531,
            646 => 646,
            851 => 851,
            1489 => 1489,
            1398 => 1398,
            1293 => 1293,
            877 => 877,
            1057 => 1057,
            659 => 659,
            1054 => 1054,
            5478 => 1601,
            979 => 979,
            5486 => 1614,
            666 => 666,
            2647 => 1627,
            820 => 820,
            1032 => 1032,
            969 => 969,
            595 => 595,
            5506 => 1666,
            1021 => 1021,
            1212 => 1212,
            697 => 697,
            690 => 690,
            1080 => 1080,
            815 => 815,
            1388 => 1388,
            676 => 676,
            1329 => 1329,
            1330 => 1330,
            770 => 770,
            934 => 934,
            1387 => 1387,
            2626 => 1567,
            1253 => 1253,
            915 => 915,
            5507 => 1667,
            1399 => 1399,
            971 => 971,
            2687 => 1703,
            693 => 693,
            692 => 692,
            5499 => 1646,
            652 => 652,
            762 => 762,
            1491 => 1491,
            926 => 926,
            654 => 654,
            1255 => 1255,
            1065 => 1065,
            521 => 521,
            5464 => 1556,
            786 => 786,
            1306 => 1306,
            706 => 706,
            912 => 912,
            372 => 372,
            1493 => 1493,
            1186 => 1186,
            1108 => 1108,
            2658 => 1637,
            1197 => 1197,
            722 => 722,
            542 => 542,
            673 => 673,
            2608 => 1517,
            878 => 878,
            1264 => 1264,
            681 => 681,
            1366 => 1366,
            608 => 608,
            1406 => 1406,
            738 => 738,
            627 => 627,
            1145 => 1145,
            721 => 721,
            1386 => 1386,
            679 => 679,
            2674 => 1685,
            964 => 964,
            755 => 755,
            1031 => 1031,
            1167 => 1167,
            1151 => 1151,
            1059 => 1059,
            2609 => 1532,
            579 => 579,
            1185 => 1185,
            1189 => 1189,
            587 => 587,
            1350 => 1350,
            1089 => 1089,
            840 => 840,
            1172 => 1172,
            740 => 740,
            619 => 619,
            1044 => 1044,
            5452 => 1522,
            941 => 941,
            1020 => 1020,
            5470 => 1589,
            548 => 548,
            1009 => 1009,
            1196 => 1196,
            829 => 829,
            1384 => 1384,
            1511 => 1511,
            776 => 776,
            5492 => 1621,
            1466 => 1466,
            1334 => 1334,
            536 => 536,
            2616 => 1544,
            699 => 699,
            1358 => 1358,
            751 => 751,
            1372 => 1372,
            960 => 960,
            1441 => 1441,
            933 => 933,
            523 => 523,
            5475 => 1596,
            1016 => 1016,
            1130 => 1130,
            1004 => 1004,
            1338 => 1338,
            850 => 850,
            522 => 522,
            552 => 552,
            1393 => 1393,
            1147 => 1147,
            1162 => 1162,
            1420 => 1420,
            1160 => 1160,
            879 => 879,
            719 => 719,
            708 => 708,
            1443 => 1443,
            1484 => 1484,
            1198 => 1198,
            1389 => 1389,
            734 => 734,
            1199 => 1199,
            985 => 985,
            1058 => 1058,
            588 => 588,
            5503 => 1656,
            713 => 713,
            1316 => 1316,
            1323 => 1323,
            529 => 529,
            1312 => 1312,
            1182 => 1182,
            560 => 560,
            698 => 698,
            927 => 927,
            825 => 825,
            1093 => 1093,
            803 => 803,
            895 => 895,
            5504 => 1664,
            2689 => 1690,
            1262 => 1262,
            1468 => 1468,
            1307 => 1307,
            940 => 940,
            943 => 943,
            1119 => 1119,
            805 => 805,
            2622 => 1555,
            1017 => 1017,
            1137 => 1137,
            880 => 880,
            665 => 665,
            1364 => 1364,
            748 => 748,
            954 => 954,
            819 => 819,
            5512 => 1677,
            622 => 622,
            1459 => 1459,
            2688 => 1702,
            601 => 601,
            2613 => 1538,
            1109 => 1109,
            1092 => 1092,
            2681 => 1695,
            1096 => 1096,
            872 => 872,
            1072 => 1072,
            1128 => 1128,
            594 => 594,
            1401 => 1401,
            2665 => 1673,
            517 => 517,
            569 => 569,
            1081 => 1081,
            5447 => 1514,
            1254 => 1254,
            865 => 865,
            1508 => 1508,
            2631 => 1572,
            1156 => 1156,
            5461 => 1549,
            564 => 564,
            2641 => 1583,
            5469 => 1587,
            1027 => 1027,
            2610 => 1533,
            1117 => 1117,
            1471 => 1471,
            953 => 953,
            2667 => 1678,
            1423 => 1423,
            1400 => 1400,
            1268 => 1268,
            993 => 993,
            796 => 796,
            1397 => 1397,
            992 => 992,
            1029 => 1029,
            695 => 695,
            5493 => 1631,
            707 => 707,
            1288 => 1288,
            842 => 842,
            516 => 516,
            1434 => 1434,
            1024 => 1024,
            801 => 801,
            5477 => 1598,
            612 => 612,
            1363 => 1363,
            1499 => 1499,
            783 => 783,
            863 => 863,
            645 => 645,
            2634 => 1575,
            5500 => 1652,
            1332 => 1332,
            1503 => 1503,
            1076 => 1076,
            1467 => 1467,
            809 => 809,
            1483 => 1483,
            813 => 813,
            875 => 875,
            2657 => 1636,
            1490 => 1490,
            963 => 963,
            847 => 847,
            551 => 551,
            2684 => 1697,
            1276 => 1276,
            952 => 952,
            891 => 891,
            5455 => 1526,
            1226 => 1226,
            920 => 920,
            991 => 991,
            951 => 951,
            1480 => 1480,
            1220 => 1220,
            1067 => 1067,
            1106 => 1106,
            1377 => 1377,
            1141 => 1141,
            1019 => 1019,
            965 => 965,
            911 => 911,
            752 => 752,
            1183 => 1183,
            557 => 557,
            1326 => 1326,
            1012 => 1012,
            1025 => 1025,
            1243 => 1243,
            1341 => 1341,
            2652 => 1632,
            1118 => 1118,
            822 => 822
        ];

        if (! in_array($feelik_design_id, $mapping_design_ids)) {
            return 0;
        }
        return array_search($feelik_design_id, $mapping_design_ids);
    }
}
